## EST ECM - Zabbix UserParameter 설정
## /etc/zabbix/zabbix_agentd.d/ecm.conf

# ================================================
# server_info 테이블
# ================================================
# Discovery Rule
UserParameter=ecm.server.discovery,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh server.discovery

# Item Prototypes
UserParameter=ecm.server.status[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh server.status ServerIndex=$1
UserParameter=ecm.server.ip[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh server.ip ServerIndex=$1

# 목록 조회
UserParameter=ecm.server.list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh server.list

# ================================================
# path_info 테이블
# ================================================
# Discovery Rule
UserParameter=ecm.path.discovery,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.discovery

# Item Prototypes
UserParameter=ecm.path.status[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.status PathIndex=$1
UserParameter=ecm.path.usesize[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.usesize PathIndex=$1
UserParameter=ecm.path.quotasize[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.quotasize PathIndex=$1
UserParameter=ecm.path.usage_percent[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.usage_percent PathIndex=$1

# 목록 조회
UserParameter=ecm.path.list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh path.list

# ================================================
# configure_function 테이블
# ================================================
# Discovery Rule
UserParameter=ecm.config_function.discovery,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_function.discovery

# Item Prototypes
UserParameter=ecm.config_function.status[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_function.status optionname=$1
UserParameter=ecm.config_function.data[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_function.data optionname=$1

# 목록 조회
UserParameter=ecm.config_function.list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_function.list

# ================================================
# configure_server 테이블
# ================================================
# Discovery Rule
UserParameter=ecm.config_server.discovery,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_server.discovery

# Item Prototypes
UserParameter=ecm.config_server.status[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_server.status optionname=$1
UserParameter=ecm.config_server.data[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_server.data optionname=$1

# 목록 조회
UserParameter=ecm.config_server.list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_server.list

# ================================================
# configure_web 테이블
# ================================================
# Discovery Rule
UserParameter=ecm.config_web.discovery,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_web.discovery

# Item Prototypes
UserParameter=ecm.config_web.status[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_web.status optionname=$1
UserParameter=ecm.config_web.data[*],sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_web.data optionname=$1

# 목록 조회
UserParameter=ecm.config_web.list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh config_web.list

# ================================================
# 보안: 랜섬웨어 의심 파일 탐지
# ================================================
# 카운트 (최근 30일)
UserParameter=ecm.security.ransomware_count,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh security.ransomware_count

# 목록 조회 (생성자명, 파일위치 포함)
UserParameter=ecm.security.ransomware_list,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh security.ransomware_list

# ================================================
# MySQL 시스템 정보
# ================================================
UserParameter=ecm.mysql.connection_count,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh mysql.connection_count
UserParameter=ecm.mysql.version,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh mysql.version
UserParameter=ecm.mysql.uptime,sudo /etc/zabbix/zabbix_agentd.d/ecm.sh mysql.uptime
